<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>GUI.GUIDefinitionsVers2</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">module</a> <a id="8" href="GUI.GUIDefinitionsVers2.html" class="Module">GUI.GUIDefinitionsVers2</a> <a id="32" class="Keyword">where</a>

<a id="39" class="Comment">-- simplifed verison of GUIDefinitions.agda and GUIDefinitionsBase.agda</a>
<a id="111" class="Comment">-- where</a>
<a id="120" class="Comment">--    the GUI data type is defined inductively and not generically</a>
<a id="187" class="Comment">--     (simpler to use)</a>
<a id="211" class="Comment">-- the handler is directly an io program returning the next GUI rather</a>
<a id="282" class="Comment">--    than being an object.</a>

<a id="311" class="Keyword">open</a> <a id="316" class="Keyword">import</a> <a id="323" href="Data.String.html" class="Module">Data.String</a>
<a id="335" class="Keyword">open</a> <a id="340" class="Keyword">import</a> <a id="347" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="356" class="Keyword">open</a> <a id="361" class="Keyword">import</a> <a id="368" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="377" class="Keyword">hiding</a> <a id="384" class="Symbol">(</a><a id="385" href="Data.Fin.html#3869" class="Function Operator">_+_</a><a id="388" class="Symbol">)</a>
<a id="390" class="Keyword">open</a> <a id="395" class="Keyword">import</a> <a id="402" href="Data.Product.html" class="Module">Data.Product</a>
<a id="415" class="Keyword">open</a> <a id="420" class="Keyword">import</a> <a id="427" href="Size.html" class="Module">Size</a>

<a id="433" class="Keyword">open</a> <a id="438" class="Keyword">import</a> <a id="445" href="SizedIO.Base.html" class="Module">SizedIO.Base</a> <a id="458" class="Keyword">renaming</a> <a id="467" class="Symbol">(</a><a id="468" href="SizedIO.Base.html#540" class="Record">IO</a> <a id="471" class="Symbol">to</a> <a id="474" href="SizedIO.Base.html#540" class="Record">IO∞</a><a id="477" class="Symbol">;</a> <a id="479" href="SizedIO.Base.html#681" class="Datatype">IO&#39;</a> <a id="483" class="Symbol">to</a> <a id="486" href="SizedIO.Base.html#681" class="Datatype">IO</a><a id="488" class="Symbol">)</a>
<a id="490" class="Keyword">open</a> <a id="495" class="Keyword">import</a> <a id="502" href="SizedIO.Console.html" class="Module">SizedIO.Console</a> <a id="518" class="Keyword">using</a> <a id="524" class="Symbol">(</a><a id="525" href="SizedIO.Console.html#360" class="Function">consoleI</a><a id="533" class="Symbol">;</a> <a id="535" href="SizedIO.Console.html#764" class="Function">translateIOConsole</a><a id="553" class="Symbol">)</a>
<a id="555" class="Keyword">open</a> <a id="560" class="Keyword">import</a> <a id="567" href="heap.libraryVec.html" class="Module">heap.libraryVec</a>

<a id="584" class="Keyword">data</a> <a id="Frame"></a><a id="589" href="GUI.GUIDefinitionsVers2.html#589" class="Datatype">Frame</a>  <a id="596" class="Symbol">:</a> <a id="598" class="PrimitiveType">Set</a> <a id="602" class="Keyword">where</a>
  <a id="Frame.emptyFrame"></a><a id="610" href="GUI.GUIDefinitionsVers2.html#610" class="InductiveConstructor">emptyFrame</a>  <a id="622" class="Symbol">:</a>  <a id="625" href="GUI.GUIDefinitionsVers2.html#589" class="Datatype">Frame</a>
  <a id="Frame.addButton"></a><a id="633" href="GUI.GUIDefinitionsVers2.html#633" class="InductiveConstructor">addButton</a>   <a id="645" class="Symbol">:</a>  <a id="648" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="655" class="Symbol">→</a> <a id="657" href="GUI.GUIDefinitionsVers2.html#589" class="Datatype">Frame</a> <a id="663" class="Symbol">→</a> <a id="665" href="GUI.GUIDefinitionsVers2.html#589" class="Datatype">Frame</a>
  <a id="Frame.addLabel"></a><a id="673" href="GUI.GUIDefinitionsVers2.html#673" class="InductiveConstructor">addLabel</a>    <a id="685" class="Symbol">:</a>  <a id="688" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="695" class="Symbol">→</a> <a id="697" href="GUI.GUIDefinitionsVers2.html#589" class="Datatype">Frame</a> <a id="703" class="Symbol">→</a> <a id="705" href="GUI.GUIDefinitionsVers2.html#589" class="Datatype">Frame</a>
  <a id="Frame.addTextbox"></a><a id="713" href="GUI.GUIDefinitionsVers2.html#713" class="InductiveConstructor">addTextbox</a>  <a id="725" class="Symbol">:</a>  <a id="728" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="735" class="Symbol">→</a> <a id="737" href="GUI.GUIDefinitionsVers2.html#589" class="Datatype">Frame</a> <a id="743" class="Symbol">→</a> <a id="745" href="GUI.GUIDefinitionsVers2.html#589" class="Datatype">Frame</a>


<a id="frame2NrButtons"></a><a id="753" href="GUI.GUIDefinitionsVers2.html#753" class="Function">frame2NrButtons</a> <a id="769" class="Symbol">:</a> <a id="771" class="Symbol">(</a><a id="772" href="GUI.GUIDefinitionsVers2.html#772" class="Bound">f</a> <a id="774" class="Symbol">:</a> <a id="776" href="GUI.GUIDefinitionsVers2.html#589" class="Datatype">Frame</a><a id="781" class="Symbol">)</a> <a id="783" class="Symbol">→</a> <a id="785" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a>
<a id="787" href="GUI.GUIDefinitionsVers2.html#753" class="Function">frame2NrButtons</a> <a id="803" href="GUI.GUIDefinitionsVers2.html#610" class="InductiveConstructor">emptyFrame</a> <a id="814" class="Symbol">=</a> <a id="816" class="Number">0</a>
<a id="818" href="GUI.GUIDefinitionsVers2.html#753" class="Function">frame2NrButtons</a> <a id="834" class="Symbol">(</a><a id="835" href="GUI.GUIDefinitionsVers2.html#633" class="InductiveConstructor">addButton</a> <a id="845" class="Symbol">_</a> <a id="847" href="GUI.GUIDefinitionsVers2.html#847" class="Bound">f</a><a id="848" class="Symbol">)</a> <a id="850" class="Symbol">=</a> <a id="852" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="856" class="Symbol">(</a><a id="857" href="GUI.GUIDefinitionsVers2.html#753" class="Function">frame2NrButtons</a> <a id="873" href="GUI.GUIDefinitionsVers2.html#847" class="Bound">f</a><a id="874" class="Symbol">)</a>
<a id="876" href="GUI.GUIDefinitionsVers2.html#753" class="Function">frame2NrButtons</a> <a id="892" class="Symbol">(</a><a id="893" href="GUI.GUIDefinitionsVers2.html#673" class="InductiveConstructor">addLabel</a> <a id="902" class="Symbol">_</a> <a id="904" href="GUI.GUIDefinitionsVers2.html#904" class="Bound">f</a><a id="905" class="Symbol">)</a> <a id="907" class="Symbol">=</a> <a id="909" href="GUI.GUIDefinitionsVers2.html#753" class="Function">frame2NrButtons</a> <a id="925" href="GUI.GUIDefinitionsVers2.html#904" class="Bound">f</a>
<a id="927" href="GUI.GUIDefinitionsVers2.html#753" class="Function">frame2NrButtons</a> <a id="943" class="Symbol">(</a><a id="944" href="GUI.GUIDefinitionsVers2.html#713" class="InductiveConstructor">addTextbox</a> <a id="955" class="Symbol">_</a> <a id="957" href="GUI.GUIDefinitionsVers2.html#957" class="Bound">f</a><a id="958" class="Symbol">)</a> <a id="960" class="Symbol">=</a> <a id="962" href="GUI.GUIDefinitionsVers2.html#753" class="Function">frame2NrButtons</a> <a id="978" href="GUI.GUIDefinitionsVers2.html#957" class="Bound">f</a>

<a id="frame2NrTextboxes"></a><a id="981" href="GUI.GUIDefinitionsVers2.html#981" class="Function">frame2NrTextboxes</a> <a id="999" class="Symbol">:</a> <a id="1001" class="Symbol">(</a><a id="1002" href="GUI.GUIDefinitionsVers2.html#1002" class="Bound">f</a> <a id="1004" class="Symbol">:</a> <a id="1006" href="GUI.GUIDefinitionsVers2.html#589" class="Datatype">Frame</a><a id="1011" class="Symbol">)</a> <a id="1013" class="Symbol">→</a> <a id="1015" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a>
<a id="1017" href="GUI.GUIDefinitionsVers2.html#981" class="Function">frame2NrTextboxes</a> <a id="1035" href="GUI.GUIDefinitionsVers2.html#610" class="InductiveConstructor">emptyFrame</a> <a id="1046" class="Symbol">=</a> <a id="1048" class="Number">0</a>
<a id="1050" href="GUI.GUIDefinitionsVers2.html#981" class="Function">frame2NrTextboxes</a> <a id="1068" class="Symbol">(</a><a id="1069" href="GUI.GUIDefinitionsVers2.html#633" class="InductiveConstructor">addButton</a> <a id="1079" class="Symbol">_</a> <a id="1081" href="GUI.GUIDefinitionsVers2.html#1081" class="Bound">f</a><a id="1082" class="Symbol">)</a> <a id="1084" class="Symbol">=</a> <a id="1086" href="GUI.GUIDefinitionsVers2.html#981" class="Function">frame2NrTextboxes</a> <a id="1104" href="GUI.GUIDefinitionsVers2.html#1081" class="Bound">f</a>
<a id="1106" href="GUI.GUIDefinitionsVers2.html#981" class="Function">frame2NrTextboxes</a> <a id="1124" class="Symbol">(</a><a id="1125" href="GUI.GUIDefinitionsVers2.html#673" class="InductiveConstructor">addLabel</a> <a id="1134" class="Symbol">_</a> <a id="1136" href="GUI.GUIDefinitionsVers2.html#1136" class="Bound">f</a><a id="1137" class="Symbol">)</a> <a id="1139" class="Symbol">=</a> <a id="1141" href="GUI.GUIDefinitionsVers2.html#981" class="Function">frame2NrTextboxes</a> <a id="1159" href="GUI.GUIDefinitionsVers2.html#1136" class="Bound">f</a>
<a id="1161" href="GUI.GUIDefinitionsVers2.html#981" class="Function">frame2NrTextboxes</a> <a id="1179" class="Symbol">(</a><a id="1180" href="GUI.GUIDefinitionsVers2.html#713" class="InductiveConstructor">addTextbox</a> <a id="1191" class="Symbol">_</a> <a id="1193" href="GUI.GUIDefinitionsVers2.html#1193" class="Bound">f</a><a id="1194" class="Symbol">)</a> <a id="1196" class="Symbol">=</a> <a id="1198" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1202" class="Symbol">(</a><a id="1203" href="GUI.GUIDefinitionsVers2.html#981" class="Function">frame2NrTextboxes</a> <a id="1221" href="GUI.GUIDefinitionsVers2.html#1193" class="Bound">f</a><a id="1222" class="Symbol">)</a>

<a id="FrameMethod"></a><a id="1225" href="GUI.GUIDefinitionsVers2.html#1225" class="Function">FrameMethod</a> <a id="1237" class="Symbol">:</a> <a id="1239" href="GUI.GUIDefinitionsVers2.html#589" class="Datatype">Frame</a> <a id="1245" class="Symbol">→</a> <a id="1247" class="PrimitiveType">Set</a>
<a id="1251" href="GUI.GUIDefinitionsVers2.html#1225" class="Function">FrameMethod</a> <a id="1263" href="GUI.GUIDefinitionsVers2.html#1263" class="Bound">f</a> <a id="1265" class="Symbol">=</a> <a id="1267" href="Data.Fin.html#910" class="Datatype">Fin</a> <a id="1271" class="Symbol">(</a><a id="1272" href="GUI.GUIDefinitionsVers2.html#753" class="Function">frame2NrButtons</a> <a id="1288" href="GUI.GUIDefinitionsVers2.html#1263" class="Bound">f</a><a id="1289" class="Symbol">)</a> <a id="1291" href="Data.Product.html#1329" class="Function Operator">×</a>  <a id="1294" href="heap.libraryVec.html#195" class="Function">Tuple</a> <a id="1300" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="1307" class="Symbol">(</a><a id="1308" href="GUI.GUIDefinitionsVers2.html#981" class="Function">frame2NrTextboxes</a> <a id="1326" href="GUI.GUIDefinitionsVers2.html#1263" class="Bound">f</a><a id="1327" class="Symbol">)</a>


<a id="1331" class="Keyword">mutual</a>
  <a id="1340" class="Keyword">record</a> <a id="GUI"></a><a id="1347" href="GUI.GUIDefinitionsVers2.html#1347" class="Record">GUI</a> <a id="1351" class="Symbol">{</a><a id="1352" href="GUI.GUIDefinitionsVers2.html#1352" class="Bound">i</a> <a id="1354" class="Symbol">:</a> <a id="1356" href="Agda.Builtin.Size.html#114" class="Postulate">Size</a><a id="1360" class="Symbol">}</a> <a id="1362" class="Symbol">:</a> <a id="1364" class="PrimitiveType">Set</a> <a id="1368" class="Keyword">where</a>
    <a id="1378" class="Keyword">coinductive</a>
    <a id="1394" class="Keyword">constructor</a> <a id="GUI.guic"></a><a id="1406" href="GUI.GUIDefinitionsVers2.html#1406" class="CoinductiveConstructor">guic</a>
    <a id="1415" class="Keyword">field</a>
      <a id="GUI.gui"></a><a id="1427" href="GUI.GUIDefinitionsVers2.html#1427" class="Field">gui</a>     <a id="1435" class="Symbol">:</a> <a id="1437" href="GUI.GUIDefinitionsVers2.html#589" class="Datatype">Frame</a>
      <a id="GUI.method"></a><a id="1449" href="GUI.GUIDefinitionsVers2.html#1449" class="Field">method</a>  <a id="1457" class="Symbol">:</a> <a id="1459" class="Symbol">{</a><a id="1460" href="GUI.GUIDefinitionsVers2.html#1460" class="Bound">j</a> <a id="1462" class="Symbol">:</a> <a id="1464" href="Agda.Builtin.Size.html#146" class="Postulate Operator">Size&lt;</a> <a id="1470" href="GUI.GUIDefinitionsVers2.html#1352" class="Bound">i</a><a id="1471" class="Symbol">}</a> <a id="1473" class="Symbol">→</a> <a id="1475" href="GUI.GUIDefinitionsVers2.html#1544" class="Function">GUIObj</a> <a id="1482" class="Symbol">{</a><a id="1483" href="GUI.GUIDefinitionsVers2.html#1460" class="Bound">j</a><a id="1484" class="Symbol">}</a> <a id="1486" href="GUI.GUIDefinitionsVers2.html#1427" class="Field">gui</a> <a id="1490" class="Comment">-- (m : FrameMethod gui) → IO consoleI ∞ (GUI {j})</a>

  <a id="GUIObj"></a><a id="1544" href="GUI.GUIDefinitionsVers2.html#1544" class="Function">GUIObj</a> <a id="1551" class="Symbol">:</a> <a id="1553" class="Symbol">{</a><a id="1554" href="GUI.GUIDefinitionsVers2.html#1554" class="Bound">i</a> <a id="1556" class="Symbol">:</a> <a id="1558" href="Agda.Builtin.Size.html#114" class="Postulate">Size</a><a id="1562" class="Symbol">}</a> <a id="1564" class="Symbol">→</a> <a id="1566" href="GUI.GUIDefinitionsVers2.html#589" class="Datatype">Frame</a> <a id="1572" class="Symbol">→</a> <a id="1574" class="PrimitiveType">Set</a>
  <a id="1580" href="GUI.GUIDefinitionsVers2.html#1544" class="Function">GUIObj</a> <a id="1587" class="Symbol">{</a><a id="1588" href="GUI.GUIDefinitionsVers2.html#1588" class="Bound">i</a><a id="1589" class="Symbol">}</a> <a id="1591" href="GUI.GUIDefinitionsVers2.html#1591" class="Bound">f</a> <a id="1593" class="Symbol">=</a> <a id="1595" class="Symbol">{</a><a id="1596" href="GUI.GUIDefinitionsVers2.html#1596" class="Bound">j</a> <a id="1598" class="Symbol">:</a> <a id="1600" href="Agda.Builtin.Size.html#146" class="Postulate Operator">Size&lt;</a> <a id="1606" href="GUI.GUIDefinitionsVers2.html#1588" class="Bound">i</a><a id="1607" class="Symbol">}(</a><a id="1609" href="GUI.GUIDefinitionsVers2.html#1609" class="Bound">m</a> <a id="1611" class="Symbol">:</a> <a id="1613" href="GUI.GUIDefinitionsVers2.html#1225" class="Function">FrameMethod</a> <a id="1625" href="GUI.GUIDefinitionsVers2.html#1591" class="Bound">f</a><a id="1626" class="Symbol">)</a> <a id="1628" class="Symbol">→</a> <a id="1630" href="SizedIO.Base.html#681" class="Datatype">IO</a> <a id="1633" href="SizedIO.Console.html#360" class="Function">consoleI</a> <a id="1642" href="Agda.Builtin.Size.html#210" class="Postulate">∞</a> <a id="1644" class="Symbol">(</a><a id="1645" href="GUI.GUIDefinitionsVers2.html#1347" class="Record">GUI</a> <a id="1649" class="Symbol">{</a><a id="1650" href="GUI.GUIDefinitionsVers2.html#1596" class="Bound">j</a><a id="1651" class="Symbol">})</a>

<a id="1655" class="Keyword">open</a> <a id="1660" href="GUI.GUIDefinitionsVers2.html#1347" class="Module">GUI</a> <a id="1664" class="Keyword">public</a>


<a id="GUIMethod"></a><a id="1673" href="GUI.GUIDefinitionsVers2.html#1673" class="Function">GUIMethod</a> <a id="1683" class="Symbol">:</a> <a id="1685" class="Symbol">{</a><a id="1686" href="GUI.GUIDefinitionsVers2.html#1686" class="Bound">i</a> <a id="1688" class="Symbol">:</a> <a id="1690" href="Agda.Builtin.Size.html#114" class="Postulate">Size</a><a id="1694" class="Symbol">}</a> <a id="1696" class="Symbol">(</a><a id="1697" href="GUI.GUIDefinitionsVers2.html#1697" class="Bound">g</a> <a id="1699" class="Symbol">:</a> <a id="1701" href="GUI.GUIDefinitionsVers2.html#1347" class="Record">GUI</a> <a id="1705" class="Symbol">{</a><a id="1706" href="GUI.GUIDefinitionsVers2.html#1686" class="Bound">i</a><a id="1707" class="Symbol">})</a> <a id="1710" class="Symbol">→</a> <a id="1712" class="PrimitiveType">Set</a>
<a id="1716" href="GUI.GUIDefinitionsVers2.html#1673" class="Function">GUIMethod</a> <a id="1726" href="GUI.GUIDefinitionsVers2.html#1726" class="Bound">g</a> <a id="1728" class="Symbol">=</a> <a id="1730" href="GUI.GUIDefinitionsVers2.html#1225" class="Function">FrameMethod</a> <a id="1742" class="Symbol">(</a><a id="1743" href="GUI.GUIDefinitionsVers2.html#1726" class="Bound">g</a> <a id="1745" class="Symbol">.</a><a id="1746" href="GUI.GUIDefinitionsVers2.html#1427" class="Field">gui</a><a id="1749" class="Symbol">)</a>
</pre></body></html>